{	
	"id" : "/post/inicializadores-c-sharp/",
	"tv" : false,
	"date": "2016-03-14 13:00:00 -0600",
	"title" : "Inicializadores en C#",
	"author" : "Antonio Feregrino Bolaños",
	"featured_image": "http://thatcsharpguy.com/postimages//aprende-c-sharp/inicializadores.png",
	"tags" :
	[ 
		"AprendeCSharp"
	],
	"content" : "<h2 id=\"inicializador-de-objetos\">Inicializador de objetos</h2>
<p>Seguramente ya conocerás que en C# para crear una instancia de un objeto es necesario utilizar alguno de los constructores de la clase que lo define. Y mientras que es te comportamiento es algo estándar para todos los lenguajes de programación orientados a objetos, C# permite hacer uso de  una sintaxis conocida como “Inicializadores de objeto”, que fue introducida en la versión 3.0 del lenguaje.</p>

<p>Para comenzar, a explicar los inicializadores, fíjate en la definición de la siguiente clase:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nf">Person</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
    <span class="p">}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="k">public</span> <span class="n">Person</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="n">Person</span> <span class="n">dad</span><span class="p">,</span> <span class="n">Person</span> <span class="n">mom</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
    <span class="n">Dad</span> <span class="p">=</span> <span class="n">dad</span><span class="p">;</span>
    <span class="n">Mom</span> <span class="p">=</span> <span class="n">mom</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="k">public</span> <span class="kt">int</span> <span class="n">Age</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="k">public</span> <span class="n">Person</span> <span class="n">Dad</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="k">public</span> <span class="n">Person</span> <span class="n">Mom</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="k">public</span> <span class="n">List</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="kt">string</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">Abilities</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">}</span> </code></pre></figure>
</code></pre>

<p>Podemos ver que para crear una persona, es necesario llamar al constructor pasándole un nombre, y dos instancias de esa misma clase, por ejemplo:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">dad</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">“</span><span class="n">Roberto</span><span class="err">”</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">mom</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">“</span><span class="n">Carla</span><span class="err">”</span><span class="p">);</span></code></pre></figure></p>

<p>Para asignar las propiedades <code>Age</code> y <code>Abilities</code> son asignadas en instrucciones por separado y una vez que el objeto ha sido creado:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">mom</span><span class="p">.</span><span class="n">Age</span> <span class="p">=</span> <span class="m">55</span><span class="p">;</span>
<span class="n">mom</span><span class="p">.</span><span class="n">Abilities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span></code></pre></figure></string></p>

<p>Hasta aquí, todo normal, pero lo que permite la inicialización de objetos es hacer uso de los constructores y además de asignar “al mismo tiempo” las propiedades o campos publicos que contiene el objeto, estén o no definidos en el constructor usado. Esto significa que para la clase <code>Person</code> podemos asignar <code>Age</code> y <code>Abilities</code> dentro de la misma instrucción:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">son</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">“</span><span class="n">Omar</span><span class="err">”</span><span class="p">,</span> <span class="n">dad</span><span class="p">,</span> <span class="n">mom</span><span class="p">)</span> 
<span class="p">{</span> 
    <span class="n">Age</span> <span class="p">=</span> <span class="m">21</span><span class="p">,</span> 
    <span class="n">Abilities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;(),</span> 
<span class="p">};</span></code></pre></figure></string></p>

<p>Las asignaciones de cada propiedad deben estar separadas con una coma y pueden ser asignadas en la misma o diferentes líneas.</p>

<p>En este caso, estamos empleando el constructor de la clase seguido por la asignación de propiedades dentro de las llaves <code>{</code> <code>}</code>, pero haciéndolo en una sola instrucción, en lugar de usar tres instrucciones separadas, como se haría tradicionalmente:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">son</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">“</span><span class="n">Omar</span><span class="err">”</span><span class="p">,</span> <span class="n">dad</span><span class="p">,</span> <span class="n">mom</span><span class="p">);</span>
<span class="n">son</span><span class="p">.</span><span class="n">Age</span> <span class="p">=</span> <span class="m">21</span><span class="p">;</span>
<span class="n">son</span><span class="p">.</span><span class="n">Abilities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span></code></pre></figure></string></p>

<p><strong>El comportamiento no se modifica, usando el inicializador de objetos primero es construido el objeto</strong> (usando el constructor) <strong>y después son asignadas las propiedades</strong> en el orden en el que están escritas dentro de las llaves.</p>

<h3 id=\"anidacin-de-inicializadores\">Anidación de inicializadores</h3>
<p>Es posible anidar inicializadores, pudiendo escribir código cómo este:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">aunt</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">“</span><span class="n">Claudia</span><span class="err">”</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Age</span> <span class="p">=</span> <span class="m">50</span><span class="p">,</span>
    <span class="n">Mom</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">“</span><span class="n">Gil</span><span class="err">”</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Age</span> <span class="p">=</span> <span class="m">78</span><span class="p">,</span>
        <span class="n">Abilities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;(),</span>
        <span class="n">Dad</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;Charlie\&quot;)</span>
        <span class="p">{</span>
            <span class="n">Age</span> <span class="p">=</span> <span class="m">106</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span></code></pre></figure></string></p>

<h3 id=\"inicializadores-y-tipos-annimos\">Inicializadores y tipos anónimos</h3>
<p>Como <a href=\"http://thatcsharpguy.com/post/anonimos-en-c-sharp/\">anteriormente escribí</a>, el inicializador de objetos cobra mucha importancia cuando trabajamos con tipos anónimos, y es que esta es la única manera de trabajar con ellos:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">album</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Title</span> <span class="p">=</span> <span class="err">“</span><span class="n">Kindred</span><span class="err">”</span><span class="p">,</span> <span class="n">Artist</span> <span class="p">=</span> <span class="err">“</span><span class="n">Passion</span> <span class="n">Pit</span><span class="err">”</span> <span class="p">};</span>
<span class="kt">var</span> <span class="n">gift</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Item</span> <span class="p">=</span> <span class="n">album</span><span class="p">,</span> <span class="n">To</span> <span class="p">=</span> <span class="n">aunt</span> <span class="p">};</span></code></pre></figure></p>

<h2 id=\"inicializacin-de-colecciones\">Inicialización de colecciones</h2>
<p>Al igual que con los objetos, también existe un inicializador para colecciones, la cual permite crear e insertar valores en un arreglo, lista o cualquier otra colección. Por ejemplo, si creamos una lista de cadenas, y luego añadimos cadenas en ella, normalmente el código se vería así:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">abilities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
<span class="n">abilities</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;programación\&quot;);</span>
<span class="n">abilities</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;futbol\&quot;);</span>
<span class="n">abilities</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;dormir\&quot;);</span></code></pre></figure></string></string></p>

<p>Sin embargo, usando el inicializador de colecciones podemos escribir lo mismo utilizando un inicializador:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">abilities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span> <span class="err">\</span><span class="s">&quot;programación\&quot;, \&quot;futbol\&quot;, \&quot;dormir\&quot;, };</span></code></pre></figure></string></string></p>

<p>Si, por ejemplo, estamos trabajando con un arreglo simple, podemos omitir el uso del operador <code>new</code>, y hacer esto:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">string</span><span class="p">[]</span> <span class="n">abilities</span> <span class="p">=</span> <span class="p">{</span> <span class="err">“</span><span class="n">programación</span><span class="err">”</span><span class="p">,</span> <span class="err">“</span><span class="n">futbol</span><span class="err">”</span><span class="p">,</span> <span class="err">“</span><span class="n">dormir</span><span class="err">”</span> <span class="p">};</span></code></pre></figure></p>

<p>Además, <a href=\"http://thatcsharpguy.com/post/arreglos-en-c-sharp-parte-1/\">como ya lo había explicado</a> en los <a href=\"http://thatcsharpguy.com/post/arreglos-en-c-sharp-parte-2/\">posts sobre arreglos</a>, se pueden programar cosas como esta:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">int</span> <span class="p">[,]</span> <span class="n">oddArray</span> <span class="p">=</span>  <span class="p">{</span> <span class="p">{</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span> <span class="p">},</span> <span class="p">{</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span> <span class="p">},</span> <span class="p">{</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span> <span class="p">}</span> <span class="p">};</span></code></pre></figure></p>

<p>Es importante señalar que entre cada elemento de nuestra colección debe existir una <code>,</code> que las separe.</p>

<h2 id=\"combinando-inicializadores\">Combinando inicializadores</h2>
<p>Podemos usar esta sintaxis siempre que la creamos conveniente, por ejemplo, si deseamos crear un objeto de nuestra clase Person con habilidades establecidas desde la instanciación de la clase, podemos hacer esto:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">daughter</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="err">“</span><span class="n">Lucille</span><span class="err">”</span><span class="p">,</span> <span class="n">dad</span><span class="p">,</span> <span class="n">mom</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Age</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
    <span class="n">Abilities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="err">\</span><span class="s">&quot;programación\&quot;,</span>
        <span class="err">\</span><span class="s">&quot;pintura\&quot;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure></string></p>

<p>O, si por otro lado, queremos crear una colección de personas:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">classAttendance</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">person</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;Rafa\&quot;) { Age = 10},</span>
    <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;Rosalinda\&quot;) { Age = 9},</span>
    <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;Javi\&quot;) { Age = 10 },</span>
    <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="err">\</span><span class="s">&quot;Dalia\&quot;) { Age = 11 },</span>
<span class="p">};</span></code></pre></figure></person></p>

<h3 id=\"un-ltimo-detalle\">Un último detalle</h3>
<p>Si eres muy fijado, te habrás dado cuenta que hay veces en que después del último elemento o asignación en un inicializador existe una coma <code>,</code>, como en el último fragmento de código visto (<code>new Person(\"Dalia\") { Age = 11 },</code>). Podrías pensar que es un error de sintaxis… pero no es así, y es que debido a que este es un “error” que puede ser cometido frecuentemente por los programadores cuando se borra el último elemento en una lista o un objeto, se decidió permitir que el último elemento esté seguido por la coma.</p>
"
}