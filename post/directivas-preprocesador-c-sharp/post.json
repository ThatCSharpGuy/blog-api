{	
	"id" : "/post/directivas-preprocesador-c-sharp/",
	"tv" : false,
	"date": "2016-02-29 04:00:00 -0600",
	"title" : "Directivas de preprocesamiento en C#",
	"author" : "Antonio Feregrino Bolaños",
	"featured_image": "http://thatcsharpguy.com/postimages/directives/featured.png",
	"tags" : ["AprendeCSharp"],
	  
	"content": '"A pesar de que C# no tenga un preprocesador de código dedicado (tal como lo tiene C), aún podemos hacer uso de algunas instrucciones que modifican el comportamiento del compilador, a estas palabras se les conoce como **directivas**.  \r\n  \r\n### Sintaxis  \r\nLa sintaxis de una directiva es simple: comienza por el símbolo `#` seguido inmediatamente por la instrucción para el compilador. Por ejemplo:\r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#define esta_es_una_directiva\r\n#region Directivas\r\n#if esta_es_una_directiva\r\n#endif\r\n#endregion\r\n</span></code></pre></figure>\r\n\r\n### Instrucciones disponibles  \r\nPodemos dividir las directivas dentro estas categorías:  \r\n\r\n#### Definición de símbolos de compilación  \r\nPrimero que nada: En C#, un símbolo de compilación es una palabra (distinta de `true` o `false`) que es definida al momento de compilar el programa. Normalmente es el entorno en el que desarrollamos el encargado de definir dichos símbolos, por ejemplo, en Visual Sutdio cuando ejecutamos un programa en configuración Debug, el símbolo `DEBUG` es definido para nuestro código, o en Xamarin.Forms los símbolos `WINDOWS`, `IOS` y `ANDROID` son definidos dependiendo del proyecto que estamos compilando.\r\n\r\nPero nosotros también podemos definirlos mediante el uso de la directiva `#define [símbolo]` y borrar la definición mediante `#undef [símbolo]`. Mira el siguiente código:\r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#define HOLA\r\n#define mundo\r\n#define PIZZA\r\n#undef mundo\r\n</span></code></pre></figure>\r\n\r\nEn este caso para el archivo quedarán definidos los símbolos `HOLA` y `PIZZA`, estas definiciones se hacen con una sola intención, que veremos más adelante. Hay que señalar que las definiciones deben ser las primeras instrucciones en cada archivo.\r\n\r\n#### Compilación condicional    \r\nLas directivas `#if`, `#else`, `#elif` y `#endif` permiten modificar el código que el compilador toma en cuenta para la compilación, funcionan de modo similar a un `if` en C#: `#if [condición]`, salvo que las condiciones simplemente son si determinado símbolo está definido o no, por ejemplo:\r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#if HOLA &amp;&amp; mundo\r\nConsole.WriteLine(\&quot;Hola mundo\&quot;);\r\n#elif HOLA\r\nConsole.WriteLine(\&quot;Hola\&quot;);\r\n#elif mundo\r\nConsole.WriteLine(\&quot;Hola\&quot;);\r\n#else\r\nConsole.WriteLine(\&quot;...\&quot;);\r\n#endif\r\n\r\n#if (HOLA || mundo) &amp;&amp; PIZZA\r\nConsole.WriteLine(\&quot;Hola o mundo y ¡pizza!\&quot;);\r\n#endif\r\n</span></code></pre></figure>\r\n\r\nEl resultado de la ejecución es\r\n \r\n<pre>\r\nHola  \r\nHola o mundo y ¡pizza!\r\n</pre>  \r\n  \r\nLos usos de la compilación condicional son muy variados, desde indicar que cierta porción de código únicamente se compile cuando estamos vamos a ejecutar una versión de prueba de nuestra aplicación hasta compilar distinto código fuente de acuerdo a la plataforma en la que se estará ejecutando la aplicación. \r\n  \r\n#### Generar errores y warnings  \r\nPodemos usar las directivas `#error` y `#warning` para hacer que el compilador \"encuentre\" errores y advertencias en nuestro código. La sintaxis es la siguiente: `#error [mensaje]` y `#warning [mensaje]`, por ejemplo:    \r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#warning It is dangerous to go alone!\r\n#error Hola! soy un error de compilación\r\n</span></code></pre></figure>  \r\n\r\nPero, ¿para qué querríamos provocar errores o *warnings* en nuestro código? yo creo que nadie. Sin embargo, usando la compilación condicional podemos \"impedir\" que el código se compile a menos que alguna configuración se cumpla, es por eso que normalmente estas directivas vienen rodeadas de `#if`, `#endif` o `#elif`:    \r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#if !DEBUG\r\n#error Whoops, este código solamente puede ser usado en configuración debug\r\n#endif\r\n</span></code></pre></figure>\r\n\r\n#### Supresión de *warnings*  \r\nDel mismo modo que podemos crear *warnings*, también podemos instruir al compilador a que ignore algunas de estas mediante el uso de la directiva `#pragma warning disable ([identificador de advertencias])`.  \r\n  \r\nNunca ha sido bueno ignorar las advertencias en nuestro código ... sin embargo se me ocurren dos escenarios principales:  \r\n  \r\n - Cuando accederemos al código de nuestro programa mediante reflexión y el compilador nos advierte que no estamos usando determinada propiedad o método.   \r\n - Cuando estamos implementando una interfaz y nuestro código únicamente llama a algunos métodos de la interfaz\r\n \r\n Cuando deshabilitamos el reconocimiento de advertencias con la directiva anterior, el efecto permanece hasta el fin del archivo, pero podemos deshabilitar dicho efecto usando la directiva `#pragma warning restore ([identificador de advertencias])`. Tomemos como ejemplo esta porción de código que como te podrás imaginar, provoca unas cuantas advertencias. \r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">nint</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">nreturn</span><span class="p">;</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">nint</span> <span class="n">zero</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">nif</span> <span class="p">(</span><span class="m">1</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">;</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span></code></pre></figure>\r\n\r\n<figure><img src='/postimages/post/directivas-preprocesador-c-sharp/post.jsonwarnings.png' alt='\"Warnings\" images_set' /></figure>  \r\n\r\nPodemos deshabilitar las advertencias una por una:\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#pragma warning disable 219\r\n            int x = 0;\r\n</span></code></pre></figure>\r\n\r\nVarias a la vez:\r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#pragma warning disable 162,219\r\n            int zero = 0;\r\n</span></code></pre></figure>\r\n\r\nO simplemente todas a la vez:\r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#pragma warning disable\r\n            if (1 != null) ;\r\n</span></code></pre></figure>\r\n  \r\n#### Organización de código  \r\nEstas son es seguramente las directivas con las que más frecuentemente te has encontrado, y es que su uso es mucho más común que las otras, su finalidad es agrupar físicamente bloques de código dentro de nuestro archivo fuente, además de que algunos IDE permiten colapsar el texto entre ella. Es importante decir que su inclusión no modifica el comportamiento del compilador.\r\n\r\nPor ejemplo:  \r\n\r\n<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="cp">#region Super bloque de código\r\nConsole.WriteLine(\&quot;Hola\&quot;);\r\n#endregion\r\n</span></code></pre></figure>  \r\n\r\nQue en Visual Studio se ve así:\r\n\r\n<figure><img src='/postimages/post/directivas-preprocesador-c-sharp/post.jsonregion.gif' alt='\"Region directive\" images_set' /></figure>  \r\n\r\n#### Para finalizar  \r\nComo puedes ver, las directivas nos pueden ayudar a personalizar nuestro código a partir de condiciones dictadas antes de la compilación del mismo, o a \"forzar\" que ciertas condiciones se cumplan para que siquiera compile. También nos ayudan a organizar nuestro código en bloques físicos dentro del archivo fuente.  \r\n\r\n"'   
}