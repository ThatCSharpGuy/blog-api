{	
	"id" : "/post/xamarin-forms-uwp/",
	"tv" : false,
	"date": "2015-12-06 15:00:00 -0600",
	"title" : "Xamarin.Forms 2 and UWP",
	"author" : "Antonio Feregrino Bolaños",
	"featured_image": "http://thatcsharpguy.com/postimagesfeatured.png",
	"tags" :
	[ 
		"Xamarin",
		"XamarinForms"
	],
	"content" : "<p>You have heard me talk about Xamarin.Forms before and you know that I’m all mobile… but what you might have missed is the fact that I’m a HUGE Windows Platform fan. This is why this new release of Xamarin has got me excited. In this release they included <a href=\"http://developer.xamarin.com/guides/cross-platform/xamarin-forms/windows/getting-started/universal\" target=\"_blank\">support for Universal Windows Platform Apps</a> which, even though is still a preview version, it is a great tool for us as developers to start bringing our apps to even more devices.</p>

<p>For this post I’ll be using a very simple app that I created in the past when I wrote about <a href=\"/post/from-console-to-mobile\">going from console to mobile</a>, however, this time is all about “from mobile to Windows Platform”.</p>

<h2 id=\"how-to\">How to…</h2>
<p>We’ll be following the official documentation, so fasten your seatbelt and get ready to learn how is Xamarin.Forms wired and called within a platform specific project.</p>

<h3 id=\"infrastructure\">Infrastructure</h3>
<p>Feel free to download the initial source code from <a href=\"https://github.com/fferegrino/Xevenshtein-UWP/releases/tag/uwp-post-1\" target=\"_blank\">here</a>, extract it somewhere and open the <code>Xevenshtein.sln</code> file. Once the solution is open, upgrade all Xamarin.Forms packages to any version 2 (Xamarin.Forms 2.0 is part of Xamarin 4 release).</p>

<p><figure><img src='/postimages/post/xamarin-forms-uwp/post.jsonxamarin-forms-2.png' alt='“Xamarin.Forms in the package manager” images_set' /></figure></p>

<p>Then add a new project, this will be our UWP app and add the Xamarin.Forms NuGet package to it</p>

<p><figure><img src='/postimages/post/xamarin-forms-uwp/post.jsonadd-uwp.png' alt='“Adding an UWP app” images_set' /></figure>
<figure><img src='/postimages/post/xamarin-forms-uwp/post.jsonadd-nuget.png' alt='“Adding the NuGet” images_set' /></figure></p>

<p>Add a reference to the project where the forms application is, for us, such project is named <code>Xevenshtein</code> and is a PCL</p>

<p><figure><img src='/postimages/post/xamarin-forms-uwp/post.jsonadd-reference.png' alt='“Adding a reference to the Forms app” images_set' /></figure></p>

<h3 id=\"code\">Code</h3>

<p>It is time to get our hands into the code: Open the <code>App.xaml.cs</code> file that was created with the UWP app, look for this handler assignation <code>rootFrame.NavigationFailed += OnNavigationFailed;</code>. Below this line we must initialize the Xamarin.Forms module (every platform specific project that uses Xamarin.Forms has to do this as one of the first things in the app lifecycle), to do so, simply call the <code>Init</code> method:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">rootFrame</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Frame</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="n">rootFrame</span><span class="p">.</span><span class="n">NavigationFailed</span> <span class="p">+=</span> <span class="n">OnNavigationFailed</span><span class="p">;&lt;/</span><span class="n">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="n">Xamarin</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">Init</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="c1">// Added support for Forms</span></code></pre></figure><br />
<br />
Then, we must get rid of the default UI inside the  <code>MainPage.xaml</code>, we won’t be using it since Forms has got us covered. Delete all code (it might be just a grid) within the <code>&lt;Page&gt;</code> and <code>&lt;/Page&gt;</code> tags.</p>

<p><figure><img src='/postimages/post/xamarin-forms-uwp/post.jsongrid-removal.png' alt='“Removing useless UI” images_set' /></figure></p>

<p>Then, we need to change our page type to a special kind of Xamarin.Forms page. First add this <em>“attribute”</em> inside the <code>&lt;Page&gt;</code> tag:</p>

<p><figure class="highlight"><pre><code class="language-xml" data-lang="xml">xmlns:forms=”using:Xamarin.Forms.Platform.UWP” </code></pre></figure>
I double-quoted <em>attribute</em> since the line above isn’t exactly an <em>attribute</em>, it is a <em>namespace</em>, somewhat like an <code>using</code> directive but for xaml. Once we have added the namespace, replace the page <code>&lt;Page </code> and <code>&lt;/Page&gt;</code> for <code>&lt;forms:WindowsPage </code> and <code>&lt;/forms:WindowsPage&gt;</code>, as you can see we’re using the <code>forms</code> namespace.</p>

<p><figure><img src='/postimages/post/xamarin-forms-uwp/post.jsonfinal-result.png' alt='“Final result” images_set' /></figure></p>

<p><br />
And that’s it for the XAML part, press <code>F7</code> to jump to the code-behind.</p>

<p>First things first, since our MainPage isn’t a <code>Page</code> but a <code>WindowsPage</code>, replace the inheritance <code>: Page</code> for <code>: WindowsPage</code></p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">sealed</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">MainPage</span> <span class="p">:</span> <span class="n">WindowsPage</span>  <span class="c1">// bye, bye “: Page”</span></code></pre></figure></p>

<p>Even though replacing the inheritance in this page isn’t needed (because the other partial definition of the class has it), I always do it, it gives me clarity of what type the page is.</p>

<p><br />
Next… the big step: load your Forms page, this is done inside the <code>MainPage</code> constructor and after the elements of the page have been initialized:</p>

<p><figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">this</span><span class="p">.</span><span class="n">InitializeComponent</span><span class="p">();&lt;/</span><span class="n">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="n">LoadApplication</span><span class="p">(</span><span class="k">new</span> <span class="n">Xevenshtein</span><span class="p">.</span><span class="n">App</span><span class="p">());</span> <span class="c1">// Call to Xamarin.Forms </span></code></pre></figure></p>

<p>And that’s it, now you have a nice UWP app in a few steps. 
<br /></p>

<h2 id=\"whats-next\">What’s next?</h2>
<p>For you: keep playing around with the Xevenshtein app (<a href=\"https://github.com/fferegrino/Xevenshtein-UWP\" target=\"_blank\">the code is on GitHub</a>), or go ahead and create an UWP version your Forms apps: just imagine one of your apps running on an Xbox One or a giant Surface Hub… but remember that this isn’t the final release so if you find a bug, be a good Xamarin citizen and <a href=\"https://bugzilla.xamarin.com/enter_bug.cgi?alias=&amp;assigned_to=&amp;attachurl=&amp;blocked=&amp;bug_file_loc=http%3A%2F%2F&amp;bug_severity=normal&amp;bug_status=NEW&amp;cf_tags=&amp;comment=&amp;contenttypeentry=&amp;contenttypemethod=autodetect&amp;contenttypeselection=text%2Fplain&amp;data=&amp;deadline=&amp;dependson=&amp;description=&amp;estimated_time=&amp;form_name=enter_bug&amp;maketemplate=Remember%20values%20as%20bookmarkable%20template&amp;op_sys=Mac%20OS&amp;product=Forms&amp;rep_platform=PC&amp;short_desc=&amp;target_milestone=UWP&amp;version=1.5.1\">report it here</a>. Oh, and don’t forget to take a look to other Xamarin 4 features, like <a href=\"http://rasmustc.com/blog/compiled-xaml-views/\" target=\"_blank\">xaml compilation</a> or the general availability of <a href=\"http://pumpingco.de/building-better-apps-with-xamarin-insights/\" target=\"_blank\">Xamarin Insights</a>.</p>

<p>For me: I’ll be using UWP to create a simple markdown viewer, I’ll post about it later on.</p>

"
}