{	
	"id" : "/post/introduction-xamarin-forms-sharpuladora/",
	"tv" : false,
	"date": "2015-12-16 12:00:00 -0600",
	"title" : "Introduction to Xamarin.Forms (Sharpuladora app)",
	"author" : "Antonio Feregrino Bolaños",
	"featured_image": "http://thatcsharpguy.com/postimages/introduction-xamarin-forms-sharpuladora/featured.png",
	"tags" : ["Xamarin","XamarinForms","Guia"],
	"content": "Who hasn't made a classic \"Hello world!\" while getting started with a new language or framework?  \n  \nWell, as classic as the \"Hello world!\" is to code a simple calculator, and for Xamarin.Forms it is not the exception. In this guide I'll show you how to use some controls to build your apps... including your very own calculator!\n\n# How does this guide work? \nThis guide uses an interactive format, it comes with code that you can test and modify as you do the exercise. The code is divided in three or four folders:  \n\n - **start** is the starting point, contains a solution ready to be used to work with.\n - **parts** contains each and every needed file to complete the guide, usually these are provided for you to use them as reference if you ever get stuck on something, of course you can copy the code. As this document is divided in *parts* to which a subfolder corresponds.   \n - **final** is the final result, the place we want to reach with this guide. This folder, as the last one, is included as reference, to show the result of this guide.  \n\n# La Sharpuladora\n\n## Introducción  \nThis guide assumes that you have a basic understanding of how Xamarin works, if you dont, I encourage you to take a look to [Getting started with Xamarin](https://developer.xamarin.com/guides/cross-platform/getting_started/). My post on [what do you need to develop in Xamarin (in spanish)](http://thatcsharpguy.com/post/xamarin-como-empiezo/) or this other about [how to go from console to mobile](http://thatcsharpguy.com/post/from-console-to-mobile/).\n\n## Part 1 - Getting familiarized with the code  \nAs every IDE does, both Xamarin Studio and Visual Studio have their own ways of managing the files that make our app work. But to summarize: these environments divide the projects per platform, so, as we want our calculator to be available in the three main mobile platforms we will have three project plus another one which is the core of the app. I wrote a post about this, if you want to know more, check: [How is my code organized in Visual Studio?](http://thatcsharpguy.com/post/code-organization-visual-studio/).  \n  \nNow is time to get our hands into the code, open up the solution `Sharpuladora.sln` that is inside the `start` folder and look a the panel in the solution explorer. For this part of the guide there is no code to add but there is code to look. Go ahead and explore, browse the solution. Once you have had enough, move on to part 2.\n\n## Part 2 - The pages\nThe graphic interface of the apps built with Xamarin.Forms are composed by a set of elements of type `Page`, you can build your own pages from scratch, however, Forms offers to us some pre-coded page templates that we can use to work with in our apps. You can see a full list of those template pages <a href=\"https://developer.xamarin.com/guides/cross-platform/xamarin-forms/controls/pages/\" target=\"_blank\">here</a>.  \n\nThe *Sharpuladora app* consists of only one page, created using a `ContentPage` since it is one of the easiest to use.  \n\n### Part 2.1 - Creating the main page  \nWhen it comes to create a new page, we have to decide whether we will create using pure C# code or use XAML, this time, we will use C#.  \n  \nCreate a new folder and name it  `Pages` inside the project named  `Sharpuladora`, then create a new C# class named  `CalcPage` inside that new folder. Make your `CalcPage` derive from  `ContentPage`.  \n\n##### Code\nFile: `CalcPage.cs` \n\n### Part 2.2 - Setting a start page    \nIt is always important to set a start page for our app and in the case of Xamarin.Forms it has to be specified through a property. That property is named `MainPage` and can be found in the `App` class (inside `App.cs`).  \n  \nIn the solution inside  `sart` the property `MainPage` is set with a page created in-place, we must change that for a reference to our `CalcPage`:  \n\n<pre class=\"csharp\">\nMainPage = new CalcPage();\n</pre>\n\n##### Code\nFile: `App.cs`\n\n## Part 3 - The layout  \nOur page works as a container for the interface elements, however we must add a layout to position those elements in the page. As with the pages, Forms has a set of layouts out of the box, <a href=\"https://developer.xamarin.com/guides/cross-platform/xamarin-forms/controls/layouts/\" target=\"_blank\">see all here</a>.  \n  \n### Part 3.1 - The Grid\nA simple calculator does not require of a lot of thought, the buttons are sorted in rows and columns, and that seems like a job for a `Grid`.  \n  \nA `Grid` is made of rows and columns which in Xamarin.Forms are specified in the form of `RowDefinition`s o `ColumnDefinition`s. Look at the following code:  \n  \n<pre class=\"csharp\">\nvar layout = new Grid();\n\n// Rows:\nlayout.RowDefinitions.Add(new RowDefinition  Height = new GridLength(2, GridUnitType.Star) );\nlayout.RowDefinitions.Add(new RowDefinition  Height = new GridLength(1, GridUnitType.Star) );\n\n// Columns:\nlayout.ColumnDefinitions.Add(new ColumnDefinition  Width = new GridLength(1, GridUnitType.Star) );\nlayout.ColumnDefinitions.Add(new ColumnDefinition  Width = new GridLength(1, GridUnitType.Star) );\n</pre>\n\nIn the code above we create a new `Grid` called `layout` and then it gets added a pair of rows and columns. Something to notice here is that a `Width` is specified for the columns and a `Height` is specified for the rows. The fact that we use `GridUnitType.Star` (or `*`) indicates that the size of the columns will be proportional to each other.  \n  \nFor this excerise, create a grid with rows and columns that represent the following figure:   \n\n post_image grid.png \"Grid\" \n  \nOnce we have created the layout, it is important to tell our page to use it as a content, the way to do it is by specifying the property `Content` at the end of the page's constructor with the following line of code:  \n\n<pre class=\"csharp\">\nContent = _layout;\n</pre>\n\n##### Code\nFile: `CalcPage.cs`\n\n## Part 4 - The interface element  \nNow that the container of our elements (the layout) has been created, it is the time to create the all the interface elements.  \n\nWe will use buttons for the digits and operators as well as a label to show the result.  \n\nInitializing controls is pretty simple, for example, to create the button that will serve as the '0' in our calculator, we must write something like the following code:  \n \n<pre class=\"csharp\">\n_b0 = new Button  Text = \"0\" ;\n</pre>\n\nOnce the control has been created we must add it to the containing layout to be shown in the screen. Remember that in this case the layout is made of rows and columns, so we must set a column number and column number where it must appear on the screen,\nthe `Grid` class allows us to set those values via the static `SetColumn` y `SetRow` methods. In the code below the first column and the fourth row are set to the button `_b0`:  \n  \n<pre class=\"csharp\">\nGrid.SetColumn(_b0, 1);\nGrid.SetRow(_b0, 4);\n</pre>  \n\nNext, we add it to the layout by using this line:  \n  \n<pre class=\"csharp\">\n_gridLayout.Children.Add(_b0);\n</pre>\n\nFor the label where the result will be shown, we will use the `SetColumnSpan` methods to indicate that our control that it has to span across more than one column within the layout. In this case, we are setting ca column span of 4 to the `_resultDisplay` label:  \n  \n<pre class=\"csharp\">\nGrid.SetColumnSpan(_resultDisplay, 4);\n</pre>\n\nWe also can use `SetRowSpan` if we want a control to use more than one row.\n\n##### Code\nFile: `CalcPage.cs`\n\n## Part 5 - The events  \nIn a calculator like the one we are doing, user interaction is required and in Xamarin.Forms such interactions are handled through events. Each of the controls we have added can have one or more events that are triggered by user interactions (or any other fragment of our code), we, as programmers, need to tell which events we want to handle and how are we going to handle them.  \n  \nFor our calculator we will handle the `Clicked` event of the buttons. To handle events is a simple task in C#, all we have to do is to assign (using the `+=` operator) an event handler to the desired control. In the code below an event is specified as a handler for the `Clicked` event of `_b0`:\n  \n<pre class=\"csharp\">\n_b0.Clicked += OnNumericButtonClicked;\n</pre>  \n\nThe `OnNumericButtonClicked` handler is just a method with `void` as return value and gets passed in two arguments:    \n\n - `object sender` which is a reference to the control that triggered the event\n - `EventArgs e` which are some arguments related to the triggered event \n\nAs an example, here is the implementation of the method for our calculator keyboard buttons. In the first line  a cast is made from `sender` to `Button`, and that is valid (and does not throw an exception) because as we said before: `sender` contains the control that triggered the event.\n   \n<pre class=\"csharp\">\nvoid OnNumericButtonClicked(object sender, EventArgs e)\n\n\tButton botonClickeado = (Button)sender;\n\tif (primerNumero == null || primerNumero == \"\")\n\t\n\t\tprimerNumero = botonClickeado.Text;\n\t\n\telse\n\t\n\t\tsegundoNumero = botonClickeado.Text;\n\t\n\n</pre>\n\nThe handlers can be shared among several controls, so you do not have to create a handler for each control you use in your application. Now is your turn to build all the calculator's logic using the controls and the event handlers. If you get stuck, you can always take a look to the file indicated below to get you started.\n\n##### Code\nFile: `CalcPage.cs`\n\n## Part 6 - A small trick    \nBy this point you may think that our calculator is (almost) completed, but that is not the case. If you run it as is, you will notice that the calculator does not fill the entire screen... this is a small bug in our code. To work around this problem we will use another kind of layout that wraps our original layout. For this a `RelativeLayout` will come handy, this layout gives us a lot of flexibility when it comes to control how the interface elements are shown. As useful as this is, it requires more configuration. Go ahead and replace the `Content = _layout;` assignation to the following fragment of code:\n  \n<pre class=\"csharp\">\n// Trick to make our calculater fullscreen\nvar relativeLayout = new RelativeLayout();\nrelativeLayout.Children.Add(_layout, // <= Original layout\n\tConstraint.Constant(0),\n\tConstraint.Constant(0),\n\tConstraint.RelativeToParent(p => p.Width),\n\tConstraint.RelativeToParent(p => p.Height));\nContent = relativeLayout;\n</pre>\n\n# What's next?\nAs you have realized, this application is not finished, we have to implement some handlers and all the calculator's logic. Your mission, should you choose to accept it, is to finish building the *Sharpuladora*. You can check the book from Charles Petzold <a href=\" https://developer.xamarin.com/guides/cross-platform/xamarin-forms/creating-mobile-apps-xamarin-forms/\" target=\"_blank\">Xamarin.Forms Book Preview 2</a>.\n"
}